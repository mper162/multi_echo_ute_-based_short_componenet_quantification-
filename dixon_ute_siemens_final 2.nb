(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71963,       1708]
NotebookOptionsPosition[     63079,       1559]
NotebookOutlinePosition[     64276,       1597]
CellTagsIndexPosition[     64112,       1588]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "QMRITools`"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.9688296135207148`*^9},
 CellLabel->
  "In[250]:=",ExpressionUUID->"01ed9796-f2d6-4f30-956a-9b972f22aa9a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"stack", " ", "=", " ", "1"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9185572724722*^9, 3.918557274427704*^9}, 
   3.96882961572423*^9},
 CellLabel->
  "In[251]:=",ExpressionUUID->"6a6ed9a4-47f4-404f-b487-2877769c889a"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB+KHh6u5+YzeOlpsLuiPA9FZ/o+SgLSt+flZV0zfOrps
+b5Jx+yto30q/7+VQPpDgNLOC0B65WKGAxWWbx3DTvn9t3Z466iVdkQ33v2t
44vSQ/tAdMzqn7t+AOkJHFusPT3eOppMulATDKTzthQ5qXu+day16ZKWD3vr
eFrunP7WureOi97NEP848a2j7s8m6fNT3jpGpfyovgSkhTg+JE+c/tZR6Q+T
4DQg3eJZP2MrkM5RXVC4cwbQnTsqKvcD6Q07FfTi57113DelVSoBSN86Kjqz
BUgz/fV5uRBIb6x6JrUYSMvLX3TcAKTddwe93Qakw32F5Zjmv3VMK1q9kBdI
u62c620IpDfttRALBNIhgh+tw4C0/tvHbolAekfTzvoSIA0AtV6f1w==
  "],
 CellLabel->
  "Out[251]=",ExpressionUUID->"c1bf970c-9ab8-4052-8132-9129326db9b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dixon data", "Subsection",
 CellChangeTimes->{{3.754895417479931*^9, 3.754895434517124*^9}, 
   3.754997531203142*^9},
 CellTags->"c:37",ExpressionUUID->"575e0865-5675-4e24-aaf3-7f1551c14298"],

Cell[CellGroupData[{

Cell["Import Data", "Subsubsection",
 CellChangeTimes->{{3.754997533020477*^9, 3.754997536760536*^9}},
 CellTags->"c:38",ExpressionUUID->"47618030-8488-43bc-b440-b6f68eec935d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", 
  "[", "\"\</Users/randikaperera/Desktop/randika-MRI data/my work/1.Leg \
data/S36\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9169260080435743`*^9, 3.91692605046017*^9}, {
   3.916937451212784*^9, 3.916937459803451*^9}, {3.917691330851944*^9, 
   3.917691340122808*^9}, 3.917696402671542*^9, {3.918118410690893*^9, 
   3.918118415835365*^9}, {3.91813996754209*^9, 3.918139970990047*^9}, {
   3.918722320263036*^9, 3.918722323436863*^9}, {3.920536794781187*^9, 
   3.920536799191186*^9}, {3.920560721936898*^9, 3.920560724769231*^9}, {
   3.920716949475332*^9, 3.920716952242132*^9}, {3.920717151303118*^9, 
   3.920717155349697*^9}, {3.920973811209694*^9, 3.920973816417501*^9}, {
   3.921052825197938*^9, 3.921052826703637*^9}, {3.922445827648337*^9, 
   3.922445831179771*^9}, {3.925991421272872*^9, 3.925991426020136*^9}, {
   3.929733490037058*^9, 3.929733497190078*^9}, 3.930212851090497*^9, 
   3.930667542003713*^9, 3.937466591017007*^9, 3.937468665327464*^9, 
   3.937468962350883*^9, {3.958745466955131*^9, 3.9587454772369223`*^9}, {
   3.968829602764329*^9, 3.968829603955696*^9}, {3.971788897024912*^9, 
   3.9717889230299053`*^9}, {3.971853513582794*^9, 3.971853544515325*^9}, 
   3.975485750649572*^9, 3.975512606892424*^9, 3.975526263613199*^9, 
   3.975680248338627*^9, 3.975703835795628*^9, 3.975776874393845*^9, {
   3.975842070988977*^9, 3.975842072585237*^9}, {3.975852520465461*^9, 
   3.9758525223731403`*^9}, {3.975852561184654*^9, 3.9758525659645147`*^9}, {
   3.975875137871793*^9, 3.975875166039104*^9}, {3.9759144996205597`*^9, 
   3.975914501591131*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"3b040aaf-f5f8-41cb-95eb-2d5c3899c467"],

Cell[BoxData["\<\"/Users/randikaperera/Desktop/randika-MRI data/my work/1.Leg \
data/S36\"\>"], "Output",
 CellChangeTimes->{
  3.917696403294386*^9, 3.9179500400158453`*^9, 3.91811841816226*^9, 
   3.918118810428667*^9, 3.9181399731435137`*^9, 3.918202025143177*^9, 
   3.918209498083426*^9, 3.918553578666555*^9, 3.9187223247306757`*^9, 
   3.918731026667485*^9, 3.920536802917541*^9, 3.920560726214506*^9, 
   3.920716956157411*^9, {3.920717179852428*^9, 3.920717207902707*^9}, 
   3.920727047823511*^9, 3.920973818104675*^9, 3.92105282981849*^9, 
   3.921053129163113*^9, 3.922445833887322*^9, 3.925991428629163*^9, 
   3.929733500645808*^9, 3.92973464794236*^9, 3.930047959861804*^9, 
   3.930212852705596*^9, 3.930212920530126*^9, 3.930213361112132*^9, 
   3.930233830787012*^9, 3.930667543779189*^9, 3.937466592880815*^9, 
   3.9374686669883137`*^9, 3.937468963659689*^9, 3.937470137876544*^9, 
   3.9374706547750473`*^9, {3.9587454705254707`*^9, 3.958745478865355*^9}, 
   3.968829641105258*^9, 3.970332906510388*^9, 3.970339936614318*^9, 
   3.971779370221661*^9, {3.971788924774151*^9, 3.9717889457275667`*^9}, {
   3.971853523530542*^9, 3.971853547052328*^9}, 3.972385681612685*^9, 
   3.972398055118635*^9, 3.975346553265623*^9, 3.975348445253923*^9, 
   3.975348499691739*^9, 3.9754231831407022`*^9, 3.975483233903734*^9, 
   3.975485754801374*^9, 3.97551261038483*^9, 3.975526265908783*^9, 
   3.975680251228801*^9, 3.975703838900622*^9, 3.975776876679308*^9, 
   3.975842074705987*^9, {3.975852524236105*^9, 3.975852533023596*^9}, 
   3.9758525677910833`*^9, {3.975875143637685*^9, 3.975875168002483*^9}, 
   3.975914503336475*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"209fa307-1e0e-4aa7-8d80-42717b318461"]
}, Open  ]],

Cell["Import Phase and Magnitude data separately", "Text",
 CellChangeTimes->{{3.754895479259831*^9, 3.754895530013085*^9}, 
   3.754902627006409*^9, {3.7549986310072975`*^9, 3.754998667595404*^9}, {
   3.916911323385412*^9, 
   3.916911333533167*^9}},ExpressionUUID->"568233a6-87a1-4e49-8e77-\
0bec52d48c61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mag", ",", " ", "vox"}], "}"}], " ", "=", " ", 
   RowBox[{"ImportNii", "[", "\"\<merged_ute_Mag.nii.gz\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"phase", ",", " ", "vox"}], "}"}], " ", "=", " ", 
   RowBox[{"ImportNii", "[", "\"\<merged_ute_Phase.nii.gz\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.917696302747547*^9, 3.9176964138370934`*^9}, {
   3.917697821101756*^9, 3.917697854044869*^9}, {3.917699739451757*^9, 
   3.91769974003452*^9}, {3.91796757656293*^9, 3.917967577495667*^9}, {
   3.918118991047357*^9, 3.918119029973027*^9}, {3.918202180419481*^9, 
   3.918202228431669*^9}, 3.918722479543832*^9, {3.921053088748324*^9, 
   3.921053089119475*^9}, {3.922450550166353*^9, 3.922450550970602*^9}, {
   3.968829660507407*^9, 3.968829664577663*^9}, 3.9754857675555983`*^9, 
   3.975680260731872*^9, 3.9757038548768873`*^9, {3.9759145215983143`*^9, 
   3.975914524470642*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"ed4adb39-ef2d-4efe-a010-9ce14cd97359"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dimensions", "[", "mag", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phase", "]"}]}], "Input",
 CellChangeTimes->{{3.917697505643259*^9, 3.9176975293185797`*^9}, {
  3.917699659932861*^9, 3.91769967660142*^9}, {3.918118689141835*^9, 
  3.918118691482539*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"6aaf5eaa-5dc2-4480-9ee5-3867411ebb27"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"40", ",", "35", ",", "192", ",", "192"}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzGkow3EYwPEhIkMyV9HMkRQymVs8Cf8NyZ2jMGeOZDnKMYmi5IWlsTdD
5FjIwhxpK14I5SoiklzvnsWLacULz+/Ft8+7r0jeXlBvw+PxYil3TpfdEoWg
cvIaYzY1CjQfZPvpudxMykZ9bePFCDlxPp7M5t8YSQL5V2v/XE3aOC5ztaTh
sXuOaVmzFNeRSfyUYn40QnWkvuJWgqAe3tO9kMM5B4bwWIQOFQyJSW712E9H
VvQpT65I1Z2X5Jp0P1p360tA2PLudk5OQzDWJ31UZSGUhnCHVlJQ1nPE9DHy
B6UcwqXMTllIOrhqMkOlCD/qpWxhCcLniT4jgIy42qpkbmT13jMVXyLh9yRC
/w6nYEYLpErmw5NUeDlF/6DxiRsS/XcbJqcRrGsdbUyX1zkPNdmUqtHukCur
yZ37Mwjb1i6liZS9D4irtAitPa2WedJsvghbIM/+TBmbZKLi+ctAmoqMIttZ
BG2597ILqUrfzxOTi2+lwflk4N1LegmJcnluDVm2PTjSSf4DDpPW3g==
  "],
 CellLabel->
  "Out[255]=",ExpressionUUID->"1897e85b-e03b-4944-9d65-4ff774b7181f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"40", ",", "35", ",", "192", ",", "192"}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzGkow3EYwPEhIkMyV9HMmUImc4sn4b8huXMU5syRLEc5JlGUvLA09maI
HAsR5khb8UIoVxGR5Hr3LF5MK154fi++fd59RfK2/DorHo8XQ7lyuqzmSASV
g8cos7FBoPkg207P5SZSNuJtHSdGyI71cmc2/UZL4sm/GtvnKtLKfomrIfWP
XbNM86q5qJZM5CcX8aMQqiI2y28lCOqhPd0LOZR9oA+LQWhXwaCY5FaOfXRk
ea/y5IpU3XlIrknXozWX3niELc8ux6RUBENd4kdlJkJJEHdoIQWl3UdMLwN/
QMohXMpslAWknbMmI0SK8KNezBIWI3yebKb7keFXWxXM9cyee6biSyT8nkDo
2+EUzCiBVMl8eJIKLyfpHzA2fkOi7279xBSCZbW9len0OuumJhtTNNodcnkl
qWN/GmHb0qk0krL3fnGlFqGlu8U8R5pMF6Hz5NmfMX2DTFA8f+lJY6FBZD2D
oC3zXHIiVWn7uWJy4a0kMI/0v3tJKyZRLs+pJoP3BoY7yH8NF9av
  "],
 CellLabel->
  "Out[256]=",ExpressionUUID->"809252fb-396a-4dfd-a126-8411c7024c89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"echos", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<TEs.txt\>\"", ",", "\"\<Table\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "1000"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"Echo", " ", "times", " ", "in", " ", "ms"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "echos", "]"}]}], "Input",
 CellChangeTimes->{{3.918202322607339*^9, 3.918202337168227*^9}, {
   3.918202367663753*^9, 3.918202374654671*^9}, {3.918202647318069*^9, 
   3.9182026538265944`*^9}, {3.918203960512425*^9, 3.918204008960086*^9}, {
   3.918204144253294*^9, 3.918204144760479*^9}, 3.968829728402588*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"85793b4e-04b4-448c-86b0-b871689f57d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00005`", ",", "0.0001`", ",", "0.00022`", ",", "0.0005`", ",", 
   FractionBox["1", "1000"], ",", "0.0015`", ",", 
   FractionBox["1", "500"], ",", "0.0023`", ",", "0.0024`", ",", "0.0024`", ",",
    "0.0028`", ",", "0.0036000000000000003`", ",", "0.0037`", ",", "0.0038`", 
   ",", 
   FractionBox["1", "250"], ",", "0.0045000000000000005`", ",", "0.0048`", ",", 
   FractionBox["1", "200"], ",", "0.005200000000000001`", ",", "0.0053`", ",", 
   FractionBox["3", "500"], ",", "0.006500000000000001`", ",", 
   "0.006500000000000001`", ",", "0.0067`", ",", "0.007200000000000001`", ",",
    "0.0078`", ",", "0.0079`", ",", "0.0079`", ",", "0.008199999999999999`", ",",
    "0.008400000000000001`", ",", "0.0095`", ",", "0.0096`", ",", 
   FractionBox["11", "1000"], ",", 
   FractionBox["11", "1000"], ",", 
   FractionBox["3", "250"]}], "}"}]], "Output",
 CellChangeTimes->{{3.918202639979302*^9, 3.918202654716929*^9}, {
   3.918203952423061*^9, 3.918203982244509*^9}, 3.91820401252984*^9, 
   3.918204271036055*^9, 3.9182043804150667`*^9, 3.918204845414844*^9, 
   3.9182075574152603`*^9, 3.918208259987511*^9, 3.918209712152419*^9, 
   3.9185537700149*^9, 3.920538363935041*^9, 3.920561493858819*^9, 
   3.920717237928015*^9, 3.920974657675282*^9, 3.921053828224313*^9, 
   3.921053967835717*^9, 3.9210541208153887`*^9, 3.922450561903915*^9, {
   3.922450600119076*^9, 3.922450616370579*^9}, 3.925991515804593*^9, 
   3.9297349541117697`*^9, 3.930047973058799*^9, {3.9300480123267107`*^9, 
   3.930048019774282*^9}, 3.930213368463105*^9, 3.930233842382387*^9, 
   3.930667572857513*^9, 3.937466974790495*^9, 3.9374689752294292`*^9, {
   3.937469141380478*^9, 3.937469166723798*^9}, 3.937470147880046*^9, 
   3.937470664833241*^9, 3.968829733377791*^9, 3.968830204845364*^9, 
   3.968830363128003*^9, 3.968830454775564*^9, 3.970332929528966*^9, 
   3.970339957157135*^9, 3.971779439246936*^9, 3.97178896337956*^9, 
   3.9718535625784883`*^9, 3.9723857011231194`*^9, 3.9723980729945793`*^9, 
   3.975346576600809*^9, 3.975348506994747*^9, 3.9754231977228203`*^9, 
   3.975483316988686*^9, 3.975485783714871*^9, 3.975512636692863*^9, 
   3.975526284643749*^9, 3.975680274051865*^9, 3.97570386956243*^9, 
   3.975776896568593*^9, 3.975842085831312*^9, 3.975852579139203*^9, 
   3.975875182452302*^9, 3.97591453652286*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"e1eff2d2-37b4-4824-9a0a-c43e0e3ccb34"],

Cell[BoxData[
 RowBox[{"{", "35", "}"}]], "Output",
 CellChangeTimes->{{3.918202639979302*^9, 3.918202654716929*^9}, {
   3.918203952423061*^9, 3.918203982244509*^9}, 3.91820401252984*^9, 
   3.918204271036055*^9, 3.9182043804150667`*^9, 3.918204845414844*^9, 
   3.9182075574152603`*^9, 3.918208259987511*^9, 3.918209712152419*^9, 
   3.9185537700149*^9, 3.920538363935041*^9, 3.920561493858819*^9, 
   3.920717237928015*^9, 3.920974657675282*^9, 3.921053828224313*^9, 
   3.921053967835717*^9, 3.9210541208153887`*^9, 3.922450561903915*^9, {
   3.922450600119076*^9, 3.922450616370579*^9}, 3.925991515804593*^9, 
   3.9297349541117697`*^9, 3.930047973058799*^9, {3.9300480123267107`*^9, 
   3.930048019774282*^9}, 3.930213368463105*^9, 3.930233842382387*^9, 
   3.930667572857513*^9, 3.937466974790495*^9, 3.9374689752294292`*^9, {
   3.937469141380478*^9, 3.937469166723798*^9}, 3.937470147880046*^9, 
   3.937470664833241*^9, 3.968829733377791*^9, 3.968830204845364*^9, 
   3.968830363128003*^9, 3.968830454775564*^9, 3.970332929528966*^9, 
   3.970339957157135*^9, 3.971779439246936*^9, 3.97178896337956*^9, 
   3.9718535625784883`*^9, 3.9723857011231194`*^9, 3.9723980729945793`*^9, 
   3.975346576600809*^9, 3.975348506994747*^9, 3.9754231977228203`*^9, 
   3.975483316988686*^9, 3.975485783714871*^9, 3.975512636692863*^9, 
   3.975526284643749*^9, 3.975680274051865*^9, 3.97570386956243*^9, 
   3.975776896568593*^9, 3.975842085831312*^9, 3.975852579139203*^9, 
   3.975875182452302*^9, 3.975914536523448*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"ef66f907-ae15-4194-b95b-b5c90193be6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Dimensions", "[", "echos", "]"}]}]], "Input",
 CellChangeTimes->{{3.968830079429213*^9, 3.968830081723563*^9}, {
  3.9688301912053127`*^9, 3.968830191563739*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"855b6036-52f3-4e79-873b-7f568eba0173"],

Cell[BoxData[
 RowBox[{"{", "35", "}"}]], "Output",
 CellChangeTimes->{
  3.968830086301903*^9, {3.968830197256558*^9, 3.968830209200816*^9}, 
   3.968830240089913*^9, 3.968830367208811*^9, 3.970332949768366*^9, 
   3.9718535657051907`*^9, 3.9723980784440937`*^9, 3.975485787708418*^9, 
   3.9758420888615522`*^9, 3.9759145412157497`*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"c3b09b5e-24f3-4a60-a9d7-723943e35b1f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"phase2", "=", " ", 
     RowBox[{"Rescale", "[", 
      RowBox[{"phase", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "[", "phase", "]"}], ",", 
         RowBox[{"Max", "[", "phase", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], "]"}]}], ";"}], "Input"], 
  "\[IndentingNewLine]", 
  RowBox[{
   StyleBox["(*", "Input"], 
   RowBox[{"ExportNii", "[", 
    RowBox[{
     RowBox[{"Clip", "[", 
      RowBox[{"mag", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1000"}], "}"}]}], "]"}], ",", "vox", ",", 
     RowBox[{"\"\<ute/UTE_results25/UTE_mag_orignal_\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
     RowBox[{"CompressNii", "->", "False"}]}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExportNii", "[", 
  RowBox[{"mag", ",", "vox", ",", 
   RowBox[{"\"\<ute/UTE_resultsfinal27/UTE_mag_orignal_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
   RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExportNii", "[", 
  RowBox[{"phase2", ",", "vox", ",", 
   RowBox[{"\"\<ute/UTE_resultsfinal27/UTE_phase_original_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
   RowBox[{"CompressNii", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.9753466085347652`*^9, {3.9754232085483503`*^9, 3.9754232115290728`*^9}, {
   3.975512686387257*^9, 3.975512694489244*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"58d91458-7b3c-46d6-8a89-6a22b107f112"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nEcho", ",", "fEcho", ",", "dEcho"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"12", ",", "1.2", ",", "1.39"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"echos", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"fEcho", " ", "+", " ", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"nEcho", "-", "1"}]}], "]"}], "dEcho"}]}], ")"}], "/", 
     "1000."}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"in", " ", "seconds"}], "*)"}], "*)"}]], "Input",
 CellChangeTimes->{{3.916928591218816*^9, 3.916928598568438*^9}, {
   3.916937540893845*^9, 3.916937541723656*^9}, 
   3.918204016112825*^9},ExpressionUUID->"76fbe8cc-b779-4ad1-b111-\
8517e987d19a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    StyleBox[
     RowBox[{"Se", 
      StyleBox["lect", "Input"]}]], 
    StyleBox[" ", "Input"], 
    StyleBox["only", "Input"], 
    StyleBox[" ", "Input"], 
    StyleBox["later", "Input"], 
    StyleBox[" ", "Input"], 
    StyleBox["echoes", "Input"], 
    StyleBox[" ", "Input"], 
    StyleBox["for", "Input"], 
    StyleBox[" ", "Input"], 
    StyleBox["dixon", "Input"], 
    StyleBox[" ", "Input"], 
    StyleBox["fit", "Input"]}], 
   StyleBox["*)", "Input"]}], 
  StyleBox["\[IndentingNewLine]", "Input"], 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"cutoff", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mag", " ", "=", " ", 
      RowBox[{"mag", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"cutoff", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phase", " ", "=", " ", 
      RowBox[{"phase", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"cutoff", ";;"}]}], "]"}], "]"}]}], ";"}]}], 
   "Input"]}]], "Input",
 CellChangeTimes->{{3.918204419810126*^9, 3.918204526732438*^9}, {
   3.918204842619473*^9, 3.9182048496810007`*^9}, {3.918207434088627*^9, 
   3.91820743460756*^9}, 3.9185530436991997`*^9, {3.918553084907749*^9, 
   3.918553101591576*^9}, 3.918553569582257*^9, {3.922450584565637*^9, 
   3.9224505935659*^9}, {3.922450637026689*^9, 3.922450637661727*^9}, {
   3.930047983682699*^9, 3.93004799378055*^9}, {3.968829767567082*^9, 
   3.968829791190123*^9}, {3.968830122515678*^9, 3.968830144793008*^9}, {
   3.968830259337555*^9, 3.968830260076782*^9}, 3.9688304385417557`*^9, {
   3.970339985502931*^9, 3.9703399864987907`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"24127770-a8ba-419b-9c04-b4707c570ba3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"echos", " ", "=", " ", 
  RowBox[{"echos", "[", 
   RowBox[{"[", 
    RowBox[{"cutoff", ";;"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.918204851616003*^9, 3.91820486227998*^9}, {
  3.918553114282819*^9, 3.918553115318306*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"62999d8a-b15f-4ae5-81e3-1a080560e798"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0024`", ",", "0.0028`", ",", "0.0036000000000000003`", ",", "0.0037`", ",",
    "0.0038`", ",", 
   FractionBox["1", "250"], ",", "0.0045000000000000005`", ",", "0.0048`", ",", 
   FractionBox["1", "200"], ",", "0.005200000000000001`", ",", "0.0053`", ",", 
   FractionBox["3", "500"], ",", "0.006500000000000001`", ",", 
   "0.006500000000000001`", ",", "0.0067`", ",", "0.007200000000000001`", ",",
    "0.0078`", ",", "0.0079`", ",", "0.0079`", ",", "0.008199999999999999`", ",",
    "0.008400000000000001`", ",", "0.0095`", ",", "0.0096`", ",", 
   FractionBox["11", "1000"], ",", 
   FractionBox["11", "1000"], ",", 
   FractionBox["3", "250"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.918204506839607*^9, 3.918204694472464*^9, 3.918204863370916*^9, 
   3.918207557741464*^9, 3.9185531158116837`*^9, 3.918553770229268*^9, 
   3.920538374488693*^9, 3.920561753597988*^9, 3.92071824150292*^9, 
   3.92097466323977*^9, 3.921053976125543*^9, 3.921054120907363*^9, {
   3.922450574260529*^9, 3.922450587449905*^9}, 3.922450640532144*^9, 
   3.925991690996808*^9, 3.92973495427367*^9, {3.930047987138848*^9, 
   3.930048021633675*^9}, 3.930213374122328*^9, 3.930233850916285*^9, 
   3.930667580150307*^9, 3.937466979705738*^9, 3.937468979078567*^9, 
   3.937470153707808*^9, 3.9374706649643793`*^9, {3.968829777292697*^9, 
   3.968829799355871*^9}, 3.968830382203168*^9, 3.968830469854239*^9, 
   3.9703329758761883`*^9, 3.970340025900653*^9, 3.971779448858808*^9, 
   3.971788975072207*^9, 3.971853571621232*^9, 3.972385710653451*^9, 
   3.972398140097576*^9, 3.975348516360183*^9, 3.975423262899498*^9, 
   3.975483411925446*^9, 3.975485839514722*^9, 3.97551271958858*^9, 
   3.9755263134329643`*^9, 3.9756803042875977`*^9, 3.975703910878449*^9, 
   3.9757769308259897`*^9, 3.975842105836459*^9, 3.975852599657998*^9, 
   3.975875203317833*^9, 3.975914565439259*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"6c951853-69e7-466c-ba50-c2510e15fca4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Rescale", " ", "phase", " ", "from"}], " ", "-", 
    RowBox[{"Pi", " ", "to"}], " ", "+", "Pi"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"phase", "=", " ", 
    RowBox[{"Rescale", "[", 
     RowBox[{"phase", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "phase", "]"}], ",", 
        RowBox[{"Max", "[", "phase", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.916938874310203*^9, 3.916938892307212*^9}, {
  3.916938998311055*^9, 3.9169390137228117`*^9}, {3.916939046187829*^9, 
  3.916939065340784*^9}, {3.916955320321952*^9, 3.916955322544718*^9}, {
  3.916955942222454*^9, 3.916955944863041*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"1f476e24-aa85-49cc-af4a-2d0b75a13442"],

Cell["Mask the background for better fitting", "Text",
 CellChangeTimes->{{3.754998713229601*^9, 
  3.754998728766362*^9}},ExpressionUUID->"8b077c22-7bc1-4b10-a8d7-\
e0fa3d116be3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanMag", "=", 
   RowBox[{"NormalizeData", "[", 
    RowBox[{"Mean", "@", 
     RowBox[{"Transpose", "@", "mag"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mask", "=", 
   RowBox[{"Mask", "[", 
    RowBox[{"meanMag", ",", "15", ",", 
     RowBox[{"MaskSmoothing", "\[Rule]", "True"}], ",", 
     RowBox[{"MaskComponents", "\[Rule]", "2"}], ",", 
     RowBox[{"MaskClosing", "\[Rule]", "2"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"PlotData", "[", "mask", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mag", ",", "phase"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MaskData", "[", 
      RowBox[{"#", ",", "mask"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"mag", ",", "phase"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.754901597258956*^9, 3.754901597375744*^9}, {
   3.754998684206936*^9, 3.75499871229408*^9}, {3.754998827495366*^9, 
   3.754998831037976*^9}, {3.916928721226517*^9, 3.916928732873547*^9}, 
   3.916938349147595*^9, 3.920538447846534*^9},
 CellLabel->
  "In[268]:=",ExpressionUUID->"53d4bfe5-eb97-4549-81b5-8c073a91cf28"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create a B0Map from phase data", "Subsubsection",
 CellChangeTimes->{{3.754901198174383*^9, 3.754901206671067*^9}},
 CellTags->"c:39",ExpressionUUID->"fea9313c-8f91-4e02-81dd-916be6ee50c7"],

Cell[CellGroupData[{

Cell[BoxData["vox"], "Input",
 CellChangeTimes->{{3.937467052388229*^9, 3.937467052945462*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"de497d8e-579f-4020-8216-9fce1deab837"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.`", ",", "2.34375`", ",", "2.34375`"}], "}"}]], "Output",
 CellChangeTimes->{3.937467053419533*^9, 3.937468988233308*^9, 
  3.937470162279018*^9, 3.93747067508876*^9, 3.968830512878518*^9, 
  3.971853585816161*^9, 3.975423318139551*^9, 3.975483451894836*^9, 
  3.975485857512374*^9, 3.9755127404499607`*^9, 3.9755263338145523`*^9, 
  3.975680314613357*^9, 3.975703935165066*^9, 3.975842123380063*^9, 
  3.975852617902759*^9, 3.9758752235139437`*^9, 3.975914582557111*^9},
 CellLabel->
  "Out[272]=",ExpressionUUID->"91f19105-4201-4735-89e2-d97ec64684ec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{"mag", ",", " ", "phase", ",", "vox"}], "]"}]], "Input",
 CellLabel->
  "In[223]:=",ExpressionUUID->"927fe673-a75b-4468-b0e8-62977299394d"],

Cell["Uses UnwrapSplit to unwrap both legs separately", "Text",
 CellChangeTimes->{{3.7584362210925198`*^9, 3.758436244684272*^9}, 
   3.768806763579346*^9},ExpressionUUID->"a2abdbbe-e2b7-4a4f-9245-\
981f672e326a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"B0Map", "=", 
   RowBox[{"mask", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"phase", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "22"}], "]"}], "]"}], "-", 
      RowBox[{"phase", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"B0MapU", "=", 
     RowBox[{"UnwrapSplit", "[", 
      RowBox[{"B0Map", ",", "mag", ",", 
       RowBox[{"UnwrapDimension", "\[Rule]", "\"\<3D\>\""}]}], "]"}]}], ";"}],
    "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "convert", " ", "the", " ", "B0map", " ", "to", " ", "Hz", " ", "for", " ",
     "dixon", " ", "reconstruction"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hz", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "Pi", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"echos", "[", 
         RowBox[{"[", "22", "]"}], "]"}], "-", 
        RowBox[{"echos", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B0Hz", "=", 
   RowBox[{"hz", " ", "B0MapU"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.916938161344713*^9, 3.916938179765617*^9}, {
   3.916938387361389*^9, 3.916938388277137*^9}, {3.916938434137681*^9, 
   3.916938434456142*^9}, {3.917972262617721*^9, 3.9179722633693113`*^9}, 
   3.918119185946302*^9, {3.918204108942699*^9, 3.918204120362821*^9}, {
   3.9182042202152443`*^9, 3.918204220563686*^9}, {3.918204920203661*^9, 
   3.918204929244418*^9}, 3.918205070177466*^9, {3.9182076717419786`*^9, 
   3.918207681954361*^9}, {3.918553183697666*^9, 3.918553186869956*^9}, {
   3.9185541970019207`*^9, 3.918554203320232*^9}, {3.920538900326818*^9, 
   3.920538930564302*^9}, {3.920561831835042*^9, 3.920561840988413*^9}, {
   3.920974703693657*^9, 3.920974709040269*^9}, {3.921054148334178*^9, 
   3.921054161862639*^9}, {3.922450686385801*^9, 3.922450696903083*^9}, {
   3.930048095664735*^9, 3.930048098729883*^9}, {3.93021340609019*^9, 
   3.930213428856523*^9}, 3.9374706106163807`*^9, {3.937470751433647*^9, 
   3.9374707587075*^9}, {3.9374711199345493`*^9, 3.937471150020309*^9}, {
   3.9703331599436693`*^9, 3.970333179077957*^9}, {3.970333209990666*^9, 
   3.970333213821671*^9}, {3.970340096965769*^9, 3.9703401071637506`*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"cf6bb248-39b7-4bf1-95ac-ebb30dd0e461"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.086961`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.920974727997578*^9, {3.921054137925169*^9, 3.9210541500949078`*^9}, 
   3.922450704314206*^9, 3.925991760957882*^9, 3.929735140495431*^9, 
   3.930048037022564*^9, 3.930048103145776*^9, {3.930213388548872*^9, 
   3.930213434483344*^9}, 3.930667610835194*^9, 3.937467061912999*^9, 
   3.937469001923155*^9, 3.937470172534136*^9, 3.937470614732977*^9, 
   3.937470762309412*^9, {3.93747112481844*^9, 3.937471153560967*^9}, {
   3.968830526508643*^9, 3.96883052988694*^9}, 3.9703332401347837`*^9, 
   3.9703401124101067`*^9, 3.9717794917205143`*^9, {3.9717890404642353`*^9, 
   3.971789060666182*^9}, 3.971853594609537*^9, 3.972385741911049*^9, 
   3.972398182935014*^9, 3.975348539023691*^9, 3.975423331266633*^9, 
   3.975483460145608*^9, 3.975485865558599*^9, 3.975512748432754*^9, 
   3.975526444412633*^9, 3.9756803220955963`*^9, 3.975703950411989*^9, 
   3.975776953768691*^9, 3.975842139353807*^9, 3.975852624424136*^9, 
   3.975875239455715*^9, 3.975914590122197*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"78927b1f-7cdf-4265-a9f3-e27f99e2b37c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{"B0MapU", ",", "B0Hz", ",", "vox", ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.754901161022546*^9, 3.754901171131878*^9}, {
   3.754901417212268*^9, 3.754901418059086*^9}, {3.754998777071891*^9, 
   3.7549988046390266`*^9}, {3.9169382119690104`*^9, 3.91693821307084*^9}, 
   3.917972234919394*^9},
 CellLabel->
  "In[373]:=",ExpressionUUID->"3714ea60-16bb-489e-a654-760dca929ff3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial phase from first echo", "Subsubsection",ExpressionUUID->"ea01092e-5871-43d8-b815-571b35a70314"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ph0", "=", 
   RowBox[{
    RowBox[{"UnwrapSplit", "[", 
     RowBox[{
      RowBox[{"phase", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "mag", ",", 
      RowBox[{"UnwrapDimension", "->", "\"\<2D\>\""}]}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "Pi"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.916939207654746*^9, 3.916939208638496*^9}, {
  3.917971258768579*^9, 3.917971259264464*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"a5ab0019-d5bc-4014-ad5b-7146413b3b84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate a T2 star map from the echos", "Subsubsection",
 CellChangeTimes->{{3.75490125599796*^9, 3.754901267038574*^9}, 
   3.864371002118687*^9},
 CellTags->"c:40",ExpressionUUID->"a2202cd6-8042-4886-9b53-4ae1c4d3c129"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s0", ",", "T2star"}], "}"}], "=", 
   RowBox[{"T2Fit", "[", 
    RowBox[{"mag", ",", "echos"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.754901290700407*^9, 3.754901324588889*^9}, {
   3.754901381050733*^9, 3.754901394283003*^9}, {3.754901646796825*^9, 
   3.754901652796183*^9}, {3.7549021603045063`*^9, 3.754902160892595*^9}, {
   3.754902212733598*^9, 3.7549022158522654`*^9}, 3.7549024289920497`*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"6dc4e651-2984-4f0d-82a8-578343d86814"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{"s0", ",", "T2star", ",", "vox", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "300"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.754901396845411*^9, 3.7549014130665936`*^9}, {
  3.754901466908824*^9, 3.75490147737572*^9}, {3.7549021722049284`*^9, 
  3.754902181595815*^9}, {3.916939128586401*^9, 3.916939129621*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"2232a64e-ff07-48e8-8991-9712c002e325"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"MedFilter", "[", "B0Hz", "]"}], ",", 
   RowBox[{"MedFilter", "[", "T2star", "]"}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.870502100901606*^9, 3.8705021468787317`*^9}, {
  3.870502190431884*^9, 3.870502257071552*^9}, {3.918207764373968*^9, 
  3.918207782665873*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"22257a1f-b098-4ea5-bdaa-9c4e72f2e3f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perform iDeal reconstruction with initial B0 and T2star", \
"Subsubsection",
 CellChangeTimes->{{3.754901503069392*^9, 3.754901520094133*^9}, {
  3.930048125413514*^9, 3.9300481267353973`*^9}},
 CellTags->"c:41",ExpressionUUID->"b3e71af8-199f-4119-a294-e0b9cceab226"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"real", " ", "=", " ", 
   RowBox[{"Re", "[", 
    RowBox[{"mag", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "phase"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imag", " ", "=", " ", 
   RowBox[{"Im", "[", 
    RowBox[{"mag", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "phase"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.916939286222974*^9, 3.916939290863834*^9}, {
  3.916939585628875*^9, 3.916939614074308*^9}, {3.916954854716361*^9, 
  3.9169550464666033`*^9}, {3.91695510028862*^9, 3.916955172277255*^9}, {
  3.916956284494769*^9, 3.916956315043459*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"69e74249-3111-40a5-b3a1-c50e072d5d53"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{"real", ",", "mag", ",", " ", "vox"}], "]"}]], "Input",
 CellChangeTimes->{{3.916939620214246*^9, 3.916939632637135*^9}, {
  3.9169540653784323`*^9, 3.916954066497778*^9}, {3.916955230697945*^9, 
  3.916955231604785*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"13da2685-434f-4aa2-a407-613275a850c4"],

Cell["The reconstruction uses a 8 peak fat spectrum by default.", "Text",
 CellChangeTimes->{{3.754901708095419*^9, 3.754901724207772*^9}, 
   3.754998889567275*^9},ExpressionUUID->"4f9f4d78-b02c-489a-b2b2-\
9395ec240489"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "@", 
  RowBox[{"Options", "[", "DixonReconstruct", "]"}]}]], "Input",
 CellChangeTimes->{{3.75490170083173*^9, 3.75490170470213*^9}, {
  3.754998892930775*^9, 3.754998895975225*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"f17f4480-b5a6-4b5c-9fca-761db422e465"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"DixonPrecessions", "\[Rule]", "1"}]},
    {
     RowBox[{"DixonFieldStrength", "\[Rule]", "3"}]},
    {
     RowBox[{"DixonNucleus", "\[Rule]", "\<\"1H\"\>"}]},
    {
     RowBox[{"DixonFrequencies", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0.`", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.81`"}], ",", 
          RowBox[{"-", "3.4000000000000004`"}], ",", 
          RowBox[{"-", "3.12`"}], ",", 
          RowBox[{"-", "2.6700000000000004`"}], ",", 
          RowBox[{"-", "2.45`"}], ",", 
          RowBox[{"-", "1.9400000000000004`"}], ",", 
          RowBox[{"-", "0.6299999999999999`"}], ",", 
          RowBox[{"-", "0.40000000000000036`"}], ",", "0.5199999999999996`", ",",
           "0.6200000000000001`"}], "}"}]}], "}"}]}]},
    {
     RowBox[{"DixonAmplitudes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.089`", ",", "0.577`", ",", "0.059`", ",", "0.093`", ",", "0.059`",
           ",", "0.013`", ",", "0.02`", ",", "0.02`", ",", "0.01`", ",", 
          "0.059`"}], "}"}]}], "}"}]}]},
    {
     RowBox[{"DixonRelaxivity", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "35", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "130", ",", "135", ",", "85", ",", "95", ",", "100", ",", "90", ",", 
          "100", ",", "100", ",", "85", ",", "85"}], "}"}]}], "}"}]}]},
    {
     RowBox[{"DixonIterations", "\[Rule]", "10"}]},
    {
     RowBox[{"DixonTolerance", "\[Rule]", "1"}]},
    {
     RowBox[{"DixonMaskThreshold", "\[Rule]", "0.1`"}]},
    {
     RowBox[{"DixonFilterInput", "\[Rule]", "False"}]},
    {
     RowBox[{"DixonFilterOutput", "\[Rule]", "True"}]},
    {
     RowBox[{"DixonFilterSize", "\[Rule]", "1"}]},
    {
     RowBox[{"DixonFilterType", "\[Rule]", "\<\"Median\"\>"}]},
    {
     RowBox[{"DixonPhases", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "True", ",", "True", ",", "False", ",", "False", ",", "False"}], 
       "}"}]}]},
    {
     RowBox[{"DixonClipFraction", "\[Rule]", "False"}]},
    {
     RowBox[{"DixonCorrectT1", "\[Rule]", "False"}]},
    {
     RowBox[{"DixonFixT2", "\[Rule]", "False"}]},
    {
     RowBox[{"DixonConstrainPhase", "\[Rule]", "False"}]},
    {
     RowBox[{"MonitorCalc", "\[Rule]", "False"}]},
    {
     RowBox[{"DixonFitPhase", "\[Rule]", "False"}]},
    {
     RowBox[{"Parallelize", "\[Rule]", "True"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.916953096911718*^9, 3.918119584901186*^9, 
  3.918121746012624*^9, 3.918206719518444*^9, 3.918556448657778*^9, 
  3.920539144974067*^9, 3.920561863321323*^9, 3.920974758284169*^9, 
  3.925991795931506*^9, 3.929735153854076*^9, 3.9374671451334677`*^9, 
  3.93747020863078*^9, 3.968830557066045*^9, 3.970333294551049*^9, 
  3.970340177985776*^9, 3.971779549756442*^9, 3.971789112398814*^9, 
  3.9718536153359823`*^9, 3.9723857669142723`*^9, 3.9723984907726727`*^9, 
  3.975348557677823*^9, 3.975423360486162*^9, 3.975483479270111*^9, 
  3.975485935220945*^9, 3.975512771280929*^9, 3.975526471201838*^9, 
  3.975680342265112*^9, 3.9757039717669764`*^9, 3.975776996314567*^9, 
  3.9758421624985857`*^9, 3.975852645466661*^9, 3.97587526367094*^9, 
  3.975914609706708*^9},
 CellLabel->
  "Out[281]=",ExpressionUUID->"ed6376b9-4f92-41ef-a755-915e963c0f23"]
}, Open  ]],

Cell["\<\
The Dixon reconstruction uses IDEAL with B0 and T2* correction\
\>", "Text",
 CellChangeTimes->{{3.758436296048541*^9, 
  3.758436325020463*^9}},ExpressionUUID->"24d1735d-55ff-4874-ae49-\
95eee726ba7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"perform", " ", "the", " ", "IDEAL", " ", "dixon", " ", "fit"}], ",",
     " ", 
    RowBox[{"B0map", " ", "in", " ", "Hz"}], ",", " ", 
    RowBox[{"T2star", " ", "in", " ", "s"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fraction", ",", "watfat", ",", "iopImages", ",", 
      RowBox[{"{", 
       RowBox[{"ph", ",", "tw"}], "}"}], ",", "itt", ",", "resDix"}], "}"}], "=", 
    RowBox[{"DixonReconstruct", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"real", ",", "imag"}], "}"}], ",", "echos", ",", 
      RowBox[{"{", 
       RowBox[{"B0Hz", ",", "T2star", ",", "ph0"}], "}"}], ",", 
      RowBox[{"DixonFilterOutput", "->", "True"}], ",", 
      RowBox[{"MonitorCalc", "->", "True"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.91387414536483*^9, {3.913874442725352*^9, 3.9138744669812984`*^9}, {
   3.9138875498668003`*^9, 3.913887551075519*^9}, {3.913887618025593*^9, 
   3.913887619121229*^9}, {3.913888389566473*^9, 3.913888477263065*^9}, {
   3.91388875954208*^9, 3.913888766042473*^9}, {3.913888896677925*^9, 
   3.91388892495755*^9}, {3.913889054768198*^9, 3.91388905882687*^9}, 
   3.913889110128656*^9, {3.916953122517976*^9, 3.91695312405372*^9}, {
   3.916956402345393*^9, 3.916956403054509*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"7e225f08-611b-4880-92ff-590dfad2df20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", "B0fit", "}"}], "=", "ph"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t2St", ",", "r2St"}], "}"}], "=", "tw"}], ";"}]}], "Input",
 CellChangeTimes->{3.913874226558319*^9},
 CellLabel->
  "In[283]:=",ExpressionUUID->"79538dc0-b237-480c-9395-89bb4c2b7db9"],

Cell[BoxData[
 RowBox[{"PlotData", "[", "T2star", "]"}]], "Input",
 CellChangeTimes->{{3.845543842608681*^9, 3.845543845266397*^9}, {
  3.920731369484921*^9, 3.920731372274701*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"24b25430-f775-47c3-a406-66595d77930d"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"1000", "t2St"}], ",", " ", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "50"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.864883596269615*^9, 3.864883612945133*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"4978cf89-7389-4892-8d1f-55648c5b487d"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"B0fit", ",", "B0Hz"}], "}"}], ",", 
   RowBox[{"MedFilter", "/@", 
    RowBox[{"{", 
     RowBox[{"t2St", ",", "T2star"}], "}"}]}], ",", "vox", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.05"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7549019554403896`*^9, 3.754901959564401*^9}, {
   3.7549020857896004`*^9, 3.754902087723256*^9}, {3.754902383757766*^9, 
   3.754902394123337*^9}, {3.7549024747014837`*^9, 3.7549024767484083`*^9}, {
   3.848397084395108*^9, 3.848397091416838*^9}, {3.8702643675548544`*^9, 
   3.8702643773703065`*^9}, {3.870264526933181*^9, 3.8702645285483046`*^9}, {
   3.8702659282860928`*^9, 3.870265928649857*^9}, {3.870266771934525*^9, 
   3.8702667724731183`*^9}, {3.870502327182955*^9, 3.870502343632017*^9}, {
   3.913874300768528*^9, 3.9138743056979446`*^9}, 3.913874935319502*^9, {
   3.918119949085874*^9, 3.918119949793379*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"e23deef6-34f4-4564-b635-8db6aa97538a"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"iopImages", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"iopImages", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", "vox"}], "]"}]], "Input",
 CellChangeTimes->{{3.754901689949265*^9, 3.7549016978680615`*^9}, {
   3.754902801139293*^9, 3.7549028300607553`*^9}, 3.917971982509961*^9},
 CellLabel->
  "In[217]:=",ExpressionUUID->"6d226abe-f82b-422d-854d-a2e435ff3da4"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"Abs", "@", 
    RowBox[{"watfat", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"Abs", "@", 
    RowBox[{"watfat", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ",", "vox"}], "]"}]], "Input",
 CellChangeTimes->{{3.754901689949265*^9, 3.7549016978680615`*^9}, {
  3.754902801139293*^9, 3.754902826685003*^9}, {3.9138882815961113`*^9, 
  3.913888315777479*^9}, {3.916952981798598*^9, 3.916952982704784*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"525f5248-09d4-426d-ad30-75831de460db"],

Cell[BoxData[
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"fraction", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"fraction", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", "vox", ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.916953020368312*^9, 3.916953021022476*^9}, {
  3.916956989294818*^9, 3.916956991884243*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"ac978ba5-eb84-4c42-987e-25395b268713"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fractionM", "=", 
   RowBox[{"DixonToPercent", "[", 
    RowBox[{
     RowBox[{"Abs", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"Abs", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.758436363630905*^9, 3.758436392588728*^9}, 
   3.913889202546594*^9},
 CellLabel->
  "In[285]:=",ExpressionUUID->"447edf0b-5f83-4014-ba0b-89316aa51e93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"watfat", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.920550850502817*^9, 3.920550857975666*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"7829b2ec-7e32-457e-954a-025f8a7c2147"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"40", ",", "192", ",", "192"}], "}"}]], "Output",
 CellChangeTimes->{3.920550858762832*^9, 3.968830612509219*^9, 
  3.9703333707586803`*^9, 3.970340249738909*^9, 3.971779686445307*^9, 
  3.9717891866732063`*^9, 3.9718536712648897`*^9, 3.9758422048525047`*^9},
 CellLabel->
  "Out[248]=",ExpressionUUID->"e973c0b5-038e-41ac-86f0-b3cd8a31b016"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"PlotData", "[", 
  RowBox[{
   RowBox[{"Transpose", "@", "fraction"}], ",", 
   RowBox[{"Transpose", "@", "fractionM"}], ",", "vox", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0", ",", "1.0"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"src", "=", 
   RowBox[{"ImportNii", "[", "\"\<merged_ute_Mag.nii.gz\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.916956547233725*^9, 3.916956548047039*^9}, {
   3.916956582603265*^9, 3.916956583428649*^9}, {3.971779699000815*^9, 
   3.9717797407438726`*^9}, 3.97548600308038*^9, 3.975680408025941*^9, {
   3.975704038351088*^9, 3.975704041268729*^9}, 3.975914664208754*^9},
 CellLabel->
  "In[286]:=",ExpressionUUID->"d667bf55-ab1b-466c-af24-99bdbd93af12"],

Cell[BoxData[{
 RowBox[{"ExportNii", "[", 
  RowBox[{
   RowBox[{"Clip", "[", 
    RowBox[{
     RowBox[{"Abs", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1000"}], "}"}]}], "]"}], ",", 
   RowBox[{"src", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"\"\<ute/UTE_resultsfinal27/water_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
   RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportNii", "[", 
   RowBox[{
    RowBox[{"Clip", "[", 
     RowBox[{
      RowBox[{"Abs", "@", 
       RowBox[{"watfat", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}]}], "]"}], ",", 
    RowBox[{"src", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"\"\<ute/UTE_resultsfinal27/fat_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
    RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ExportNii", "[", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{"Abs", "@", 
          RowBox[{"iopImages", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "400"}], "}"}]}], "]"}], ",", 
       RowBox[{"src", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"\"\<ute/UTE_results4/inphase_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
       RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"ExportNii", "[", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Clip", "[", 
          RowBox[{
           RowBox[{"Abs", "@", 
            RowBox[{"iopImages", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "400"}], "}"}]}], "]"}], ",", 
         RowBox[{"src", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"\"\<ute/UTE_results4/outphase_\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
         RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"ExportNii", "[", 
        RowBox[{
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Clip", "[", 
            RowBox[{
             RowBox[{"Abs", "@", 
              RowBox[{"fractionM", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1.1"}], "}"}], "*", "100"}]}], "]"}], ",", 
           RowBox[{"src", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"\"\<ute/UTE_results4/ff_\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
           RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"ExportNii", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Clip", "[", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"fraction", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1.1"}], "}"}], "*", "100"}]}], "]"}], ",", 
            
            RowBox[{"src", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"\"\<ute/UTE_results4/wf_\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
            RowBox[{"CompressNii", "->", "False"}]}], "]"}]}]}]}]}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExportNii", "[", 
  RowBox[{
   RowBox[{"Clip", "[", 
    RowBox[{
     RowBox[{"Abs", "@", 
      RowBox[{"fraction", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1.1"}], "}"}], "*", "100"}]}], "]"}], ",", 
   RowBox[{"src", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"\"\<ute/UTE_resultsfinal27/ff_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
   RowBox[{"CompressNii", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.91812008798452*^9, 3.9181203078347054`*^9}, {
   3.918120366157853*^9, 3.918120371283949*^9}, {3.918120452241713*^9, 
   3.918120517987101*^9}, {3.918120556956406*^9, 3.918120572085202*^9}, {
   3.918120672365302*^9, 3.918120728653501*^9}, {3.9181207959784536`*^9, 
   3.918120830057156*^9}, {3.918120863519304*^9, 3.91812096638943*^9}, {
   3.918122326275949*^9, 3.918122334323414*^9}, {3.918557245732184*^9, 
   3.918557265541718*^9}, {3.918557303635267*^9, 3.918557319230114*^9}, {
   3.920547768855908*^9, 3.9205478177641487`*^9}, 3.920548002106336*^9, 
   3.920550418206531*^9, 3.920550831221779*^9, 3.920554405468788*^9, 
   3.920554539051465*^9, 3.9205546792307663`*^9, {3.920554859770018*^9, 
   3.920554935438087*^9}, {3.9207296771482058`*^9, 3.9207296807808332`*^9}, {
   3.925991884756042*^9, 3.925991886552207*^9}, {3.930667902436537*^9, 
   3.930667905426558*^9}, 3.937471354650984*^9, {3.970333379651916*^9, 
   3.9703333854308023`*^9}, {3.970340268652382*^9, 3.97034028317638*^9}, {
   3.971779820252948*^9, 3.9717798338682833`*^9}, {3.971779897423594*^9, 
   3.971779927607172*^9}, 3.971779964568008*^9, {3.971780037111533*^9, 
   3.9717800493358517`*^9}, {3.971780232476161*^9, 3.971780233065515*^9}, {
   3.9717804157330303`*^9, 3.971780481285488*^9}, {3.971780539919566*^9, 
   3.9717806055799227`*^9}, {3.971780654695065*^9, 3.971780659545432*^9}, {
   3.971781433277164*^9, 3.971781448613985*^9}, {3.9718536968305817`*^9, 
   3.971853701459196*^9}, 3.972385355919866*^9, 3.97238539020019*^9, {
   3.97238543653377*^9, 3.972385440076033*^9}, {3.972385553896818*^9, 
   3.972385580565543*^9}, 3.972385851993795*^9, 3.972398000810951*^9, {
   3.9723986721337833`*^9, 3.972398675632524*^9}, {3.975423455132378*^9, 
   3.975423469797624*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"6196fd62-48d2-4931-8c7c-af4bbd1fb2e9"],

Cell[BoxData[{
 RowBox[{"ExportNii", "[", 
  RowBox[{
   RowBox[{"Clip", "[", 
    RowBox[{
     RowBox[{"1000", "*", "t2St"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "100"}], "}"}]}], "]"}], ",", 
   RowBox[{"src", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"\"\<ute/UTE_resultsfinal27/t2s_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
   RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExportNii", "[", 
  RowBox[{
   RowBox[{"Clip", "[", 
    RowBox[{"B0fit", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "400"}], ",", "400"}], "}"}]}], "]"}], ",", 
   RowBox[{"src", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"\"\<ute/UTE_resultsfinal27/b0_\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
   RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportNii", "[", 
   RowBox[{"r2St", ",", 
    RowBox[{"src", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"\"\<ute/UTE_resultsfinal27/r2s_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
    RowBox[{"CompressNii", "->", "False"}]}], "]"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"waterMag", "=", 
     RowBox[{"Abs", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", 
    RowBox[{"waterPhase", "=", 
     RowBox[{"Arg", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"waterMag", "=", 
     RowBox[{"Abs", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", 
    RowBox[{"waterPhase", "=", 
     RowBox[{"Arg", "@", 
      RowBox[{"watfat", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fatMag", "=", 
   RowBox[{"Abs", "@", 
    RowBox[{"watfat", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fatPhase", "=", 
    RowBox[{"Arg", "@", 
     RowBox[{"watfat", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"waterMagClip", "=", 
     RowBox[{"Clip", "[", 
      RowBox[{"waterMag", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1000"}], "}"}]}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fatMagClip", "=", 
    RowBox[{"Clip", "[", 
     RowBox[{"fatMag", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"waterPhaseNorm", "=", 
     RowBox[{"Rescale", "[", 
      RowBox[{"waterPhase", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fatPhaseNorm", "=", 
    RowBox[{"Rescale", "[", 
     RowBox[{"fatPhase", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uteMag", ",", "voxUTE"}], "}"}], "=", 
     RowBox[{"ImportNii", "[", "\"\<merged_ute_mag.nii.gz\>\"", "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ExportNii", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"waterMagClip", ",", "3"}], "]"}], ",", "voxUTE", ",", 
      RowBox[{"\"\<ute/UTE_results3/water_mag_\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
      RowBox[{"CompressNii", "->", "False"}]}], "]"}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"ExportNii", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"waterPhaseNorm", ",", "3"}], "]"}], ",", "voxUTE", ",", 
      RowBox[{"\"\<ute/UTE_results3/water_phase_\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
      RowBox[{"CompressNii", "->", "False"}]}], "]"}], ";"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"-", 
      RowBox[{"Fat", "--"}]}]}], "-"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportNii", "[", 
    RowBox[{"fatMagClip", ",", 
     RowBox[{"src", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"\"\<ute/UTE_resultsfinal27/fat_mag_\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
     RowBox[{"CompressNii", "->", "False"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ExportNii", "[", 
     RowBox[{"fatPhaseNorm", ",", "vox", ",", 
      RowBox[{"\"\<ute/UTE_resultsfinal27/fat_phase_\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"stack", "-", "1"}], "]"}]}], ",", 
      RowBox[{"CompressNii", "->", "False"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.920716772545846*^9, 3.920716807924376*^9}, {
   3.920727431959613*^9, 3.9207274668368692`*^9}, {3.920727529026639*^9, 
   3.920727534562355*^9}, {3.920731287224422*^9, 3.920731289136669*^9}, {
   3.920732365891596*^9, 3.920732381276039*^9}, {3.9209749394502563`*^9, 
   3.920974940504498*^9}, 3.920975933911941*^9, {3.920976101001218*^9, 
   3.9209761125899076`*^9}, 3.920976251181356*^9, {3.930233895971201*^9, 
   3.9302339219342127`*^9}, 3.930233957865655*^9, {3.970333387058878*^9, 
   3.970333390377315*^9}, {3.970333450082348*^9, 3.970333478164439*^9}, {
   3.970333628050639*^9, 3.9703336328588123`*^9}, {3.970340285675366*^9, 
   3.9703402913695993`*^9}, {3.9703403844261923`*^9, 3.970340390774734*^9}, {
   3.9717807455642967`*^9, 3.971780771372294*^9}, {3.971780805592449*^9, 
   3.971780807444644*^9}, 3.971780844711493*^9, {3.971781635580217*^9, 
   3.971781687996023*^9}, {3.9717817288429317`*^9, 3.9717817331881447`*^9}, {
   3.971781853955051*^9, 3.971781862231996*^9}, {3.971782005567408*^9, 
   3.971782049793726*^9}, {3.971782131012064*^9, 3.971782151204996*^9}, {
   3.971782250625321*^9, 3.971782262929803*^9}, {3.971783321286768*^9, 
   3.971783322745852*^9}, {3.9717842290748568`*^9, 3.971784231506752*^9}, {
   3.971853707960629*^9, 3.971853729729969*^9}, {3.972385599771575*^9, 
   3.9723856086556168`*^9}, {3.972398677974432*^9, 3.972398701954956*^9}, {
   3.975423471958129*^9, 3.9754234923294*^9}, {3.9754836224353437`*^9, 
   3.975483622768043*^9}, {3.9754836792970953`*^9, 3.9754836874321213`*^9}, {
   3.975485447770932*^9, 3.9754854482827177`*^9}, {3.97548608086532*^9, 
   3.975486082615411*^9}, 3.975526646616057*^9},
 CellLabel->
  "In[291]:=",ExpressionUUID->"ae5b8beb-8183-4d2d-b125-c0b86d2f1a11"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.975484943021764*^9, 3.975484993504348*^9}, 
   3.9754863500371733`*^9},ExpressionUUID->"893e24c1-e1d4-4d33-ac5e-\
63d5c3cd08f2"],

Cell[CellGroupData[{

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.9703336631074133`*^9, 3.97178424604617*^9, {3.975485009049542*^9, 
   3.975485041865185*^9}, 
   3.975486347756115*^9},ExpressionUUID->"053d87cb-b8d2-442c-a978-\
13d16d48fa54"],

Cell[BoxData[
 TemplateBox[{
  "Take", "take", 
   "\"Cannot take positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"4\\\"}]\\) in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"10.`\\\", \\\",\\\", \\\"2.34375`\\\", \\\",\\\", \
\\\"2.34375`\\\"}], \\\"}\\\"}], \\\"[\\\", \\\"\\\\\\\"Dim\\\\\\\"\\\", \
\\\"]\\\"}]\\).\"", 2, 52, 2, 34701316810946023451, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.975485056018744*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"334db61d-1afb-4071-be61-ec4cd244b8d5"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"List\\\"}]\\) in \
\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"10.`\\\", \\\",\\\", \
\\\"2.34375`\\\", \\\",\\\", \\\"2.34375`\\\"}], \\\"}\\\"}], \\\"[\\\", \\\"\
\\\\\\\"Dim\\\\\\\"\\\", \\\"]\\\"}]\\) is Protected.\"", 2, 52, 3, 
   34701316810946023451, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.97548505603973*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"9ffa3d45-ded7-43b1-b6d1-9b69df3e13d2"],

Cell[BoxData[
 TemplateBox[{
  "Take", "take", 
   "\"Cannot take positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"4\\\"}]\\) in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"10.`\\\", \\\",\\\", \\\"2.34375`\\\", \\\",\\\", \
\\\"2.34375`\\\"}], \\\"}\\\"}], \\\"[\\\", \\\"\\\\\\\"PixDim\\\\\\\"\\\", \
\\\"]\\\"}]\\).\"", 2, 53, 4, 34701316810946023451, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.975485056041502*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"2e15c2d2-243b-4dd1-97bf-1d03babd14ea"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"List\\\"}]\\) in \
\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"10.`\\\", \\\",\\\", \
\\\"2.34375`\\\", \\\",\\\", \\\"2.34375`\\\"}], \\\"}\\\"}], \\\"[\\\", \\\"\
\\\\\\\"PixDim\\\\\\\"\\\", \\\"]\\\"}]\\) is Protected.\"", 2, 53, 5, 
   34701316810946023451, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.975485056042856*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"58cdc843-31be-4a89-b633-f5a89896c40f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.971784248125293*^9, 3.971784250212069*^9}, 
   3.975485080466365*^9, 
   3.975485614632662*^9},ExpressionUUID->"a0187973-0ea1-4cf0-bc35-\
971c5fe5860f"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{
  3.971784253405246*^9, {3.97548519276167*^9, 3.97548519458574*^9}, {
   3.975485347806254*^9, 3.975485355754818*^9}, 
   3.97548561263588*^9},ExpressionUUID->"d656a6ba-b797-4695-bf1e-\
cab70ab1d309"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.975485610840579*^9, 
  3.9754856108413887`*^9}},ExpressionUUID->"52d9051e-d987-416a-ae1e-\
e0ec288c54d1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.975485461161455*^9, 3.975485462718573*^9}, 
   3.9754856085848923`*^9},ExpressionUUID->"078b572e-2ccf-4b70-9509-\
312fcc9f80e8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9717842552682734`*^9},ExpressionUUID->"d9cc8995-3da0-40d4-a878-\
d64101dc50cd"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.971784257155208*^9},ExpressionUUID->"110e7bc3-75bb-42aa-b7d4-\
aaca94043053"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.970333751905706*^9, 3.9703337622464123`*^9}, 
   3.970340414418363*^9, 
   3.9717842590185833`*^9},ExpressionUUID->"f96e7ae9-ae52-4129-8b48-\
052f85917cd5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9703404758896027`*^9, 
  3.9717842606427298`*^9},ExpressionUUID->"1c4cd739-58f3-456d-8208-\
5a7e9f385cdd"],

Cell[BoxData["\n"], "Input",
 CellChangeTimes->{{3.970340613867581*^9, 3.970340646919989*^9}, {
  3.971784262431837*^9, 
  3.97178426406633*^9}},ExpressionUUID->"531ca453-2509-4f8a-9877-\
a11048dfd185"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{227, Automatic}, {Automatic, 55}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b7cd30c5-ca4a-499d-a454-539dc018d5d4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "c:37"->{
  Cell[1688, 53, 198, 3, 53, "Subsection",ExpressionUUID->"575e0865-5675-4e24-aaf3-7f1551c14298",
   CellTags->"c:37"]},
 "c:38"->{
  Cell[1911, 60, 176, 2, 43, "Subsubsection",ExpressionUUID->"47618030-8488-43bc-b440-b6f68eec935d",
   CellTags->"c:38"]},
 "c:39"->{
  Cell[23569, 542, 195, 2, 43, "Subsubsection",ExpressionUUID->"fea9313c-8f91-4e02-81dd-916be6ee50c7",
   CellTags->"c:39"]},
 "c:40"->{
  Cell[30112, 703, 228, 3, 43, "Subsubsection",ExpressionUUID->"a2202cd6-8042-4886-9b53-4ae1c4d3c129",
   CellTags->"c:40"]},
 "c:41"->{
  Cell[32195, 758, 273, 4, 43, "Subsubsection",ExpressionUUID->"b3e71af8-199f-4119-a294-e0b9cceab226",
   CellTags->"c:41"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"c:37", 63422, 1570},
 {"c:38", 63554, 1573},
 {"c:39", 63689, 1576},
 {"c:40", 63826, 1579},
 {"c:41", 63963, 1582}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 217, 5, 49, "Input",ExpressionUUID->"01ed9796-f2d6-4f30-956a-9b972f22aa9a"],
Cell[CellGroupData[{
Cell[800, 29, 271, 6, 49, "Input",ExpressionUUID->"6a6ed9a4-47f4-404f-b487-2877769c889a"],
Cell[1074, 37, 577, 11, 33, "Output",ExpressionUUID->"c1bf970c-9ab8-4052-8132-9129326db9b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1688, 53, 198, 3, 53, "Subsection",ExpressionUUID->"575e0865-5675-4e24-aaf3-7f1551c14298",
 CellTags->"c:37"],
Cell[CellGroupData[{
Cell[1911, 60, 176, 2, 43, "Subsubsection",ExpressionUUID->"47618030-8488-43bc-b440-b6f68eec935d",
 CellTags->"c:38"],
Cell[CellGroupData[{
Cell[2112, 66, 1706, 26, 29, "Input",ExpressionUUID->"3b040aaf-f5f8-41cb-95eb-2d5c3899c467"],
Cell[3821, 94, 1729, 26, 33, "Output",ExpressionUUID->"209fa307-1e0e-4aa7-8d80-42717b318461"]
}, Open  ]],
Cell[5565, 123, 309, 5, 33, "Text",ExpressionUUID->"568233a6-87a1-4e49-8e77-0bec52d48c61"],
Cell[5877, 130, 1102, 23, 49, "Input",ExpressionUUID->"ed4adb39-ef2d-4efe-a010-9ce14cd97359"],
Cell[CellGroupData[{
Cell[7004, 157, 383, 7, 49, "Input",ExpressionUUID->"6aaf5eaa-5dc2-4480-9ee5-3867411ebb27"],
Cell[7390, 166, 770, 15, 33, "Output",ExpressionUUID->"1897e85b-e03b-4944-9d65-4ff774b7181f"],
Cell[8163, 183, 766, 15, 33, "Output",ExpressionUUID->"809252fb-396a-4dfd-a126-8411c7024c89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8966, 203, 775, 16, 49, "Input",ExpressionUUID->"85793b4e-04b4-448c-86b0-b871689f57d7"],
Cell[9744, 221, 2447, 38, 82, "Output",ExpressionUUID->"e1eff2d2-37b4-4824-9a0a-c43e0e3ccb34"],
Cell[12194, 261, 1601, 24, 33, "Output",ExpressionUUID->"ef66f907-ae15-4194-b95b-b5c90193be6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13832, 290, 326, 6, 70, "Input",ExpressionUUID->"855b6036-52f3-4e79-873b-7f568eba0173"],
Cell[14161, 298, 421, 8, 33, "Output",ExpressionUUID->"c3b09b5e-24f3-4a60-a9d7-723943e35b1f"]
}, Open  ]],
Cell[14597, 309, 1694, 43, 90, "Input",ExpressionUUID->"58d91458-7b3c-46d6-8a89-6a22b107f112"],
Cell[16294, 354, 795, 23, 49, "Input",ExpressionUUID->"76fbe8cc-b779-4ad1-b111-8517e987d19a"],
Cell[17092, 379, 1822, 48, 90, "Input",ExpressionUUID->"24127770-a8ba-419b-9c04-b4707c570ba3"],
Cell[CellGroupData[{
Cell[18939, 431, 342, 8, 29, "Input",ExpressionUUID->"62999d8a-b15f-4ae5-81e3-1a080560e798"],
Cell[19284, 441, 1998, 33, 82, "Output",ExpressionUUID->"6c951853-69e7-466c-ba50-c2510e15fca4"]
}, Open  ]],
Cell[21297, 477, 904, 24, 49, "Input",ExpressionUUID->"1f476e24-aa85-49cc-af4a-2d0b75a13442"],
Cell[22204, 503, 180, 3, 33, "Text",ExpressionUUID->"8b077c22-7bc1-4b10-a8d7-e0fa3d116be3"],
Cell[22387, 508, 1145, 29, 90, "Input",ExpressionUUID->"53d4bfe5-eb97-4549-81b5-8c073a91cf28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23569, 542, 195, 2, 43, "Subsubsection",ExpressionUUID->"fea9313c-8f91-4e02-81dd-916be6ee50c7",
 CellTags->"c:39"],
Cell[CellGroupData[{
Cell[23789, 548, 178, 3, 29, "Input",ExpressionUUID->"de497d8e-579f-4020-8216-9fce1deab837"],
Cell[23970, 553, 597, 10, 33, "Output",ExpressionUUID->"91f19105-4201-4735-89e2-d97ec64684ec"]
}, Open  ]],
Cell[24582, 566, 190, 4, 29, "Input",ExpressionUUID->"927fe673-a75b-4468-b0e8-62977299394d"],
Cell[24775, 572, 214, 3, 33, "Text",ExpressionUUID->"a2abdbbe-e2b7-4a4f-9245-981f672e326a"],
Cell[CellGroupData[{
Cell[25014, 579, 2479, 55, 111, "Input",ExpressionUUID->"cf6bb248-39b7-4bf1-95ac-ebb30dd0e461"],
Cell[27496, 636, 1164, 19, 33, "Output",ExpressionUUID->"78927b1f-7cdf-4265-a9f3-e27f99e2b37c"]
}, Open  ]],
Cell[28675, 658, 689, 18, 29, "Input",ExpressionUUID->"3714ea60-16bb-489e-a654-760dca929ff3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29401, 681, 109, 0, 43, "Subsubsection",ExpressionUUID->"ea01092e-5871-43d8-b815-571b35a70314"],
Cell[29513, 683, 562, 15, 29, "Input",ExpressionUUID->"a5ab0019-d5bc-4014-ad5b-7146413b3b84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30112, 703, 228, 3, 43, "Subsubsection",ExpressionUUID->"a2202cd6-8042-4886-9b53-4ae1c4d3c129",
 CellTags->"c:40"],
Cell[30343, 708, 559, 12, 29, "Input",ExpressionUUID->"6dc4e651-2984-4f0d-82a8-578343d86814"],
Cell[30905, 722, 605, 13, 29, "Input",ExpressionUUID->"2232a64e-ff07-48e8-8991-9712c002e325"],
Cell[31513, 737, 645, 16, 29, "Input",ExpressionUUID->"22257a1f-b098-4ea5-bdaa-9c4e72f2e3f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32195, 758, 273, 4, 43, "Subsubsection",ExpressionUUID->"b3e71af8-199f-4119-a294-e0b9cceab226",
 CellTags->"c:41"],
Cell[32471, 764, 748, 18, 49, "Input",ExpressionUUID->"69e74249-3111-40a5-b3a1-c50e072d5d53"],
Cell[33222, 784, 355, 7, 29, "Input",ExpressionUUID->"13da2685-434f-4aa2-a407-613275a850c4"],
Cell[33580, 793, 222, 3, 33, "Text",ExpressionUUID->"4f9f4d78-b02c-489a-b2b2-9395ec240489"],
Cell[CellGroupData[{
Cell[33827, 800, 299, 6, 29, "Input",ExpressionUUID->"f17f4480-b5a6-4b5c-9fca-761db422e465"],
Cell[34129, 808, 3599, 95, 373, "Output",ExpressionUUID->"ed6376b9-4f92-41ef-a755-915e963c0f23"]
}, Open  ]],
Cell[37743, 906, 212, 5, 33, "Text",ExpressionUUID->"24d1735d-55ff-4874-ae49-95eee726ba7e"],
Cell[37958, 913, 1432, 32, 49, "Input",ExpressionUUID->"7e225f08-611b-4880-92ff-590dfad2df20"],
Cell[39393, 947, 347, 10, 49, "Input",ExpressionUUID->"79538dc0-b237-480c-9395-89bb4c2b7db9"],
Cell[39743, 959, 264, 5, 29, "Input",ExpressionUUID->"24b25430-f775-47c3-a406-66595d77930d"],
Cell[40010, 966, 348, 9, 29, "Input",ExpressionUUID->"4978cf89-7389-4892-8d1f-55648c5b487d"],
Cell[40361, 977, 1209, 25, 29, "Input",ExpressionUUID->"e23deef6-34f4-4564-b635-8db6aa97538a"],
Cell[41573, 1004, 445, 10, 29, "Input",ExpressionUUID->"6d226abe-f82b-422d-854d-a2e435ff3da4"],
Cell[42021, 1016, 567, 13, 29, "Input",ExpressionUUID->"525f5248-09d4-426d-ad30-75831de460db"],
Cell[42591, 1031, 510, 13, 29, "Input",ExpressionUUID->"ac978ba5-eb84-4c42-987e-25395b268713"],
Cell[43104, 1046, 503, 14, 29, "Input",ExpressionUUID->"447edf0b-5f83-4014-ba0b-89316aa51e93"],
Cell[CellGroupData[{
Cell[43632, 1064, 269, 6, 29, "Input",ExpressionUUID->"7829b2ec-7e32-457e-954a-025f8a7c2147"],
Cell[43904, 1072, 381, 7, 33, "Output",ExpressionUUID->"e973c0b5-038e-41ac-86f0-b3cd8a31b016"]
}, Open  ]],
Cell[44300, 1082, 784, 17, 49, "Input",ExpressionUUID->"d667bf55-ab1b-466c-af24-99bdbd93af12"],
Cell[45087, 1101, 6308, 146, 151, "Input",ExpressionUUID->"6196fd62-48d2-4931-8c7c-af4bbd1fb2e9"],
Cell[51398, 1249, 7185, 180, 647, "Input",ExpressionUUID->"ae5b8beb-8183-4d2d-b125-c0b86d2f1a11"],
Cell[58586, 1431, 196, 3, 49, "Input",ExpressionUUID->"893e24c1-e1d4-4d33-ac5e-63d5c3cd08f2"],
Cell[CellGroupData[{
Cell[58807, 1438, 246, 5, 49, "Input",ExpressionUUID->"053d87cb-b8d2-442c-a978-13d16d48fa54"],
Cell[59056, 1445, 592, 13, 26, "Message",ExpressionUUID->"334db61d-1afb-4071-be61-ec4cd244b8d5"],
Cell[59651, 1460, 551, 13, 26, "Message",ExpressionUUID->"9ffa3d45-ded7-43b1-b6d1-9b69df3e13d2"],
Cell[60205, 1475, 595, 13, 26, "Message",ExpressionUUID->"2e15c2d2-243b-4dd1-97bf-1d03babd14ea"],
Cell[60803, 1490, 555, 13, 26, "Message",ExpressionUUID->"58cdc843-31be-4a89-b633-f5a89896c40f"]
}, Open  ]],
Cell[61373, 1506, 255, 5, 70, "Input",ExpressionUUID->"a0187973-0ea1-4cf0-bc35-971c5fe5860f"],
Cell[61631, 1513, 249, 5, 49, "Input",ExpressionUUID->"d656a6ba-b797-4695-bf1e-cab70ab1d309"],
Cell[61883, 1520, 154, 3, 29, "Input",ExpressionUUID->"52d9051e-d987-416a-ae1e-e0ec288c54d1"],
Cell[62040, 1525, 177, 3, 29, "Input",ExpressionUUID->"078b572e-2ccf-4b70-9509-312fcc9f80e8"],
Cell[62220, 1530, 130, 3, 29, "Input",ExpressionUUID->"d9cc8995-3da0-40d4-a878-d64101dc50cd"],
Cell[62353, 1535, 128, 3, 29, "Input",ExpressionUUID->"110e7bc3-75bb-42aa-b7d4-aaca94043053"],
Cell[62484, 1540, 205, 4, 29, "Input",ExpressionUUID->"f96e7ae9-ae52-4129-8b48-052f85917cd5"],
Cell[62692, 1546, 154, 3, 29, "Input",ExpressionUUID->"1c4cd739-58f3-456d-8208-5a7e9f385cdd"],
Cell[62849, 1551, 202, 4, 49, "Input",ExpressionUUID->"531ca453-2509-4f8a-9877-a11048dfd185"]
}, Open  ]]
}, Open  ]]
}
]
*)

